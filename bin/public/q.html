<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Search Page</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  #answer { margin-top: 20px; }
  .material { margin-top: 10px; border: 1px solid #ddd; padding: 10px; border-radius: 5px; }
  .material a { text-decoration: none; color: #000; } /* Style for clickable materials */
</style>
</head>
<body>

<div>
  <input type="text" id="searchBox" placeholder="Enter search term" onkeypress="handleKeyPress(event)">
  <button onclick="search(false)">Search</button>
  <button onclick="search(true)">Answer</button>
</div>

<div id="answer"></div>
<div id="materials"></div>

<script>
function search(isQn) {
  var content = document.getElementById('searchBox').value;
  fetch('http://localhost:4567/q', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ q: content, qn: isQn })
  })
  .then(response => response.json())
  .then(data => {
    document.getElementById('answer').innerText = data.ans || "";

    const materialsDiv = document.getElementById('materials');
    materialsDiv.innerHTML = ''; // Clear previous results
    data.refs.forEach(material => {
      const materialDiv = document.createElement('div');
      materialDiv.classList.add('material');

      const materialLink = document.createElement('a');
      materialLink.href = material.path; // Set the href to the material's URL
      materialLink.target = '_blank';
      materialLink.innerText = material.score
      materialDiv.appendChild(materialLink); // Append the anchor to the material div

      const materialText = document.createElement('p');
      materialText.innerText = material.text
      materialDiv.appendChild(materialText)

      materialsDiv.appendChild(materialDiv); // Append the material div to the container
    });
  })
  .catch(error => {
    console.error('Error:', error);
  });
}

function handleKeyPress(event) {
  if (event.key === 'Enter') {
    search(false);
  }
}
</script>

</body>
</html>
